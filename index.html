<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Blockchain Simulator</title>
    <link rel="stylesheet" href="style4.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    />
  </head>
  <body>
    <div class="navbar">
      <button id="tab-home" class="active">HOME</button>
      <button id="tab-about">ABOUT ME</button>
      <button id="tab-hash">HASH</button>
      <button id="tab-block">BLOCK</button>
      <button id="tab-chain">BLOCK CHAIN</button>
      <button id="tab-ecc">ECC SIGNATURE</button>
      <button id="tab-consensus">KONSENSUS</button>
    </div>

    <main>
      <div id="page-home" class="page active">
        <header class="hero">
          <div class="hero-content">
            <h1 class="hero-title-main">BLOCKCHAIN SIMULATOR</h1>
            <p class="hero-subtitle-main">
              Tempat belajar konsep Blockchain, Hash, Mining, ECC Signature, dan
              Konsensus.
            </p>
            <div id="datetime">
              <small>WAKTU LOKAL SAAT INI</small>
              <div id="current-time"></div>
            </div>
          </div>
        </header>

        <section class="home-features">
          <h2>Fitur Blockchain Simulator</h2>
          <div class="feature-grid">
            <div class="feature-item" data-page-id="page-hash">
              <h3>HASH</h3>
              <p>
               Masukkan teks dan lihat hasil SHA-256 Hash yang akan otomatis berubah setiap kali teks diubah.
              </p>
            </div>
            <div class="feature-item" data-page-id="page-block">
              <h3>BLOCK</h3>
              <p>
                Ganti nomor block, input data, dan atur kecepatan mining untuk menemukan Hash Block baru.
              </p>
            </div>
            <div class="feature-item" data-page-id="page-chain">
              <h3>BLOCK CHAIN</h3>
              <p>
                Masukkan data, tekan Mine, lalu Add Block untuk menambah blok baru sambil memperhatikan keterkaitan melalui Previous Hash.
              </p>
            </div>
            <div class="feature-item" data-page-id="page-ecc">
              <h3>ECC SIGNATURE</h3>
              <p>
                Buat Key Pair, tulis pesan, tekan Sign Message untuk menghasilkan signature, lalu gunakan Verify Signature untuk memeriksa validitasnya.
              </p>
            </div>
            <div class="feature-item" data-page-id="page-consensus">
              <h3>KONSENSUS</h3>
              <p>
                Simulasi transaksi, mining blok baru, dan tekan tombol Konsensus untuk memperbaiki blok yang diubah
              </p>
            </div>
          </div>
        </section>
      </div>

      <div id="page-about" class="page">
        <div class="container">
          <div class="section profile-main-container">
            <h3 class="profile-label">PROFIL</h3>
              
              
              <div class="name-description-wrapper">
                <h2 class="profile-name-aligned">Safira Rachma Dewi</h2>
                <p>
                  Saya adalah mahasiswa Teknologi Rekayasa Multimedia yang
                  memiliki ketertarikan besar pada 3D Modeling dan aktif
                  mengembangkan keterampilan melalui berbagai proyek langsung
                  serta kolaborasi dalam tim dan organisasi mahasiswa. Saya
                  bersemangat untuk berinovasi di industri kreatif digital, terus
                  belajar, dan menantang diri sendiri, termasuk dalam
                  meningkatkan kemampuan berbicara di depan umum.
                </p>
              </div>
            </div>
          </div>
          <hr />

          <div class="section">
            <div class="timeline-container">
              <h3>PENDIDIKAN</h3>
              <div class="exp-box">
                <p>
                  <b>Politeknik Elektronika Negeri Surabaya</b>
                  <br />D4 Teknologi Rekayasa Multimedia
                </p>
                <p>
                  <b>SMA Negeri 1 Waru Sidoarjo</b>
                  <br />MIPA
                </p>
              </div>
              <hr />
              <h3>PENGHARGAAN</h3>
              <div class="exp-box">
                <p><b>30 Besar Finalis Approve BIZCLASH</b></p>
                <p>
                  Sebagai **Chief Marketing Officer Lelicious**, berperan dalam
                  penyusunan proposal dan riset pasar yang membawa tim masuk 30
                  besar ajang BIZZClass oleh Kasir Pintar.
                </p>
              </div>
              <hr />
              <h3>PENGALAMAN ORGANISASI</h3>
              <div class="exp-box">
                <p><b>Oktober 2025 – Sekarang</b></p>
                <p>
                  <b>HIMA Multimedia Broadcasting – Kepala Departemen Kreatif</b>
                </p>
                <ul>
                  <li>
                    Memimpin dan membimbing staff muda dalam program
                    pengembangan warga.
                  </li>
                  <li>
                    Meningkatkan minat dan bakat anggota komunitas DTMK melalui
                    keiatan kreatif.
                  </li>
                </ul>
                <p><b>Oktober 2024 – Agustus 2025</b></p>
                <p>
                  <b>FKMPI – Tim Kerja Nasional Bidang Kepemudaan</b>
                </p>
                <ul>
                  <li>
                    Mendukung program nasional untuk peningkatan keterampilan dan
                    pengetahuan anggota.
                  </li>
                </ul>
              </div>
              <hr />
              <h3>PENGALAMAN KERJA</h3>
              <div class="exp-box">
                <p><b>Part Time – Crew Outlet</b></p>
                <ul>
                  <li>
                    Melayani pelanggan, menyiapkan pesanan, dan menjaga
                    kebersihan area outlet.
                  </li>
                  <li>
                    Mengembangkan kemampuan komunikasi, kerja sama tim, dan
                    pelayanan pelanggan.
                  </li>
                </ul>
                <p><b>Freelance – 3D Modeling</b></p>
                <ul>
                  <li>
                    Membuat dan mengembangkan model 3D karakter, furniture, dan
                    elemen interior.
                  </li>
                  <li>
                    Berkoordinasi dengan klien untuk konsep dan revisi proyek.
                  </li>
                </ul>
              </div>
              <hr />
              <h3>PENGALAMAN KEPANITIAAN</h3>
              <div class="exp-box">
                <p>
                  <b>Agustus 2025</b> - PKKMB X TECHNOGEAR PENS 2025 – Steering
                  Committee
                </p>
              </div>
              <div class="exp-box">
                <p>
                  <b>April 2025</b> - DTMK CUP – Steering Committee & Ketua
                  Pelaksana
                </p>
              </div>
              <div class="exp-box">
                <p>
                  <b>Februari 2025</b> - HIMA Multimedia Broadcasting - Indigo
                  World Orientation – Steering Committee
                </p>
              </div>
              <div class="exp-box">
                <p>
                  <b>Februari 2025</b> - DTMK EXPO – Steering Committee &
                  Sekretaris
                </p>
              </div>
              <div class="exp-box">
                <p>
                  <b>Agustus 2024</b> - PKKMB X TECHNOGEAR PENS 2024 – Divisi
                  Liaison Officer
                </p>
              </div>
            </div>
          </div>
          <hr />

          <div class="section contact-section">
            <h3>KONTAK</h3>
            <div class="contact-info-container">
              <div class="contact-info-box">
                <div class="contact-icon">
                  <i class="fas fa-envelope"></i>
                </div>
                <div class="contact-text">
                  <h4>Email</h4>
                  <p>safiraachmaa.01@gmail.com</p>
                </div>
              </div>

              <div class="contact-info-box">
                <div class="contact-icon">
                  <i class="fas fa-phone-alt"></i>
                </div>
                <div class="contact-text">
                  <h4>Telepon</h4>
                  <p>+6281331811250</p>
                </div>
              </div>

              <div class="contact-info-box">
                <div class="contact-icon">
                  <i class="fab fa-instagram"></i>
                </div>
                <div class="contact-text">
                  <h4>Instagram</h4>
                  <p>@safirachma</p>
                </div>
              </div>
            </div>

            <iframe
              src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3957.654817578028!2d112.79169177499997!3d-7.280173692725455!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x2dd7fa1028b3f2c5%3A0x860a975b94bfd0a!2sPoliteknik%20Elektronika%20Negeri%20Surabaya!5e0!3m2!1sen!2sid!4v1731675496587!5m2!1sen!2sid"
              width="100%"
              height="350"
              style="border: 0; border-radius: 10px; margin-top: 20px"
              loading="lazy"
              allowfullscreen=""
              referrerpolicy="no-referrer-when-downgrade"
            ></iframe>
          </div>
        </div>
      </div>

      <div id="page-hash" class="page">
        <h2>Hash Generator (SHA-256)</h2>
        <label for="hash-input">Text Input:</label>
        <textarea id="hash-input" rows="4"></textarea>
        <label>SHA-256 Hash:</label>
        <div id="hash-output" class="output"></div>
      </div>

      <div id="page-block" class="page">
        <h2>Single Block & Mining</h2>

        <div class="blockchain-block" id="single-block-container">
          <label for="block-number"># (Nomor Block):</label>
          <input id="block-number" type="number" min="0" value="0" />

          <label for="block-data">Data:</label>
          <textarea id="block-data" rows="4"></textarea>

          <label for="block-nonce">Nonce:</label>
          <input id="block-nonce" type="text" maxlength="9" value="0" />

          <label for="block-timestamp">Timestamp:</label>
          <input id="block-timestamp" type="text" readonly />

          <label>Hash:</label>
          <div id="block-hash" class="output"></div>

          <label for="mining-difficulty">Prefix Hash:</label>
          <input id="mining-difficulty" type="text" value="0000" readonly/>

          <button id="btn-mine" class="mine">Mine</button>

          <label for="speed-control">Kecepatan Mining:</label>
          <select id="speed-control">
            <option value="1">Normal (1x)</option>
            <option value="10">10x Lebih Cepat</option>
            <option value="50">50x Lebih Cepat</option>
          </select>

          <div id="mining-status" class="status">Menunggu...</div>
        </div>
      </div>

      <div id="page-chain" class="page">
        <h2>Blockchain Sederhana</h2>
        <div id="blockchain" class="chain-container">
          </div>
        <div class="chain-controls">
          <button id="btn-add-block">Add Block</button>
        </div>
      </div>

      <div id="page-ecc" class="page">
        <h2>Verifikasi ECC Digital Signature</h2>

        <button id="btn-generate-key">Generate Key Pair (Publik & Private)</button>
        <p>
          <small
            >Public Key dan Private Key dapat diedit untuk percobaan, namun ini
            akan membatalkan pasangan kunci.</small
          >
        </p>

        <label>Public Key:</label>
        <textarea id="ecc-public" rows="3"></textarea>

        <label>Private Key:</label>
        <textarea id="ecc-private" rows="3"></textarea>

        <hr />
        <label>Pesan yang akan ditandatangani:</label>
        <textarea id="ecc-message" rows="3"></textarea>

        <button id="btn-sign">Sign Message</button>
        <label>Hasil Signature:</label>
        <textarea id="ecc-signature" rows="3" readonly></textarea>

        <hr />
        <button id="btn-verify">Verify Signature</button>
        <div id="ecc-verify-result" class="output"></div>
      </div>

      <div id="page-consensus" class="page">
        <h2>Simulasi Konsensus</h2>

        <div class="wallets">
          <div class="wallet" data-user="A">
            <h3>User A</h3>
            <div>Saldo: <span id="saldo-A">100</span></div>
            <label>Penerima:</label>
            <select id="receiver-A">
              <option value="B">User B</option>
              <option value="C">User C</option>
            </select>
            <label>Jumlah:</label>
            <input id="amount-A" type="number" min="1" value="10" />
            <button id="send-A">Kirim Transaksi</button>
          </div>

          <div class="wallet" data-user="B">
            <h3>User B</h3>
            <div>Saldo: <span id="saldo-B">100</span></div>
            <label>Penerima:</label>
            <select id="receiver-B">
              <option value="A">User A</option>
              <option value="C">User C</option>
            </select>
            <label>Jumlah:</label>
            <input id="amount-B" type="number" min="1" value="10" />
            <button id="send-B">Kirim Transaksi</button>
          </div>

          <div class="wallet" data-user="C">
            <h3>User C</h3>
            <div>Saldo: <span id="saldo-C">100</span></div>
            <label>Penerima:</label>
            <select id="receiver-C">
              <option value="A">User A</option>
              <option value="B">User B</option>
            </select>
            <label>Jumlah:</label>
            <input id="amount-C" type="number" min="1" value="10" />
            <button id="send-C">Kirim Transaksi</button>
          </div>
        </div>

        <div style="margin-top: 12px">
          <label>Mempool (pending transactions):</label>
          <textarea
            id="mempool"
            rows="3"
            placeholder="Setiap transaksi di baris baru. Contoh: A -> B:10. Akan diisi otomatis saat 'Kirim' diklik."
            readonly
          ></textarea>
        </div>

        <div style="margin-top: 12px">
          <button id="btn-mine-all">Mine Semua Transaksi</button>
          <button id="btn-verify-consensus">Verifikasi Rantai</button>
          <button id="btn-consensus">Terapkan Konsensus</button>
        </div>

        <h3 style="margin-top: 20px">Blockchain Tiap User</h3>
        <p>
          <small
            >Setiap user memiliki salinan Blockchain-nya sendiri. Konsensus
            dipakai untuk menyamakan versi tervalid.</small
          >
        </p>
        <div id="chains">
          <h4>Database User A</h4>
          <div id="chain-A" class="chain-row">
            </div>
          <h4>Database User B</h4>
          <div id="chain-B" class="chain-row">
            </div>
          <h4>Database User C</h4>
          <div id="chain-C" class="chain-row">
            </div>
        </div>
      </div>
    </main>
 <div class="footer">
      <div class="footer-content">
        <img src="Logo_PENS.png" class="footer-logo" />
        <img src="Logo_TRM.png" class="footer-logo" />
      </div>
    <footer class="footer-bottom">
      <div class="footer-logos">
        

      </div>

      <p class="footer-copy">
        Surabaya, Jawa Timur | safiraachmaa.01@gmail.com | +6281331811250
      </p>
      <p class="footer-copy">
        © 2025 D4 Teknologi Rekayasa Multimedia | Politeknik Elektronika Negeri
        Surabaya
      </p>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/elliptic/6.5.4/elliptic.min.js"></script>

    <script src="app4.js"></script>
    <script>
      // ================== DATE & TIME ==================
      function updateTime() {
        const timeElement = document.getElementById("current-time");
        if (timeElement) {
          const now = new Date();
          const options = {
            weekday: "long",
            year: "numeric",
            month: "long",
            day: "numeric",
            hour: "2-digit",
            minute: "2-digit",
            second: "2-digit",
            timeZoneName: "short",
          };
          // Menggunakan 'id-ID' untuk bahasa Indonesia
          const formattedTime = now.toLocaleDateString("id-ID", options);
          timeElement.textContent = formattedTime;
        }
      }
      setInterval(updateTime, 1000);
      updateTime();

      // ================== SHA-256 ==================
      async function sha256(msg) {
        const enc = new TextEncoder();
        const buf = await crypto.subtle.digest("SHA-256", enc.encode(msg));
        return Array.from(new Uint8Array(buf))
          .map((b) => b.toString(16).padStart(2, "0"))
          .join("");
      }

      // ================== NAVIGATION ==================
      function showPage(pageId) {
        document
          .querySelectorAll(".page")
          .forEach((p) => p.classList.remove("active"));
        document
          .querySelectorAll(".navbar button")
          .forEach((b) => b.classList.remove("active"));
        document.getElementById(pageId).classList.add("active");
        // Update Navbar active state
        const tabId = "tab-" + pageId.split("-")[1];
        const tabElement = document.getElementById(tabId);
        if (tabElement) {
          tabElement.classList.add("active");
        }
      }

      // Navbar navigation setup
      [
        "home",
        "about",
        "hash",
        "block",
        "chain",
        "ecc",
        "consensus",
      ].forEach((p) => {
        const t = document.getElementById("tab-" + p);
        if (t) {
          t.addEventListener("click", () => showPage("page-" + p));
        }
      });

      // Feature items navigation setup
      document.querySelectorAll(".feature-item").forEach((item) => {
        const pageId = item.getAttribute("data-page-id");
        if (pageId) {
          item.addEventListener("click", () => showPage(pageId));
          item.style.cursor = "pointer"; // Ensure cursor is pointer
        }
      });

      // ================== HASH PAGE ==================
      document.getElementById("hash-input").addEventListener("input", async (e) => {
        document.getElementById("hash-output").textContent = await sha256(
          e.target.value
        );
      });

      // ================== BLOCK PAGE ==================
      const blockData = document.getElementById("block-data");
      const blockNonce = document.getElementById("block-nonce");
      const blockHash = document.getElementById("block-hash");
      const blockTimestamp = document.getElementById("block-timestamp");
      const speedControl = document.getElementById("speed-control");
      const difficultyInput = document.getElementById("mining-difficulty");
      const difficulty = difficultyInput ? difficultyInput.value : "0000"; // Ambil dari input atau default

      blockNonce.addEventListener("input", (e) => {
        // Hanya izinkan angka, bersihkan input jika ada karakter lain
        e.target.value = e.target.value.replace(/[^0-9]/g, "");
        updateBlockHash();
      });
      blockData.addEventListener("input", updateBlockHash);

      async function updateBlockHash() {
        const data = blockData.value;
        const nonce = blockNonce.value || "0";
        // Untuk Block Hash, perlu menyertakan semua data block: #, Data, Nonce, Timestamp
        const blockNumber = document.getElementById("block-number").value;
        const timestamp = blockTimestamp.value;
        const hashInput = `${blockNumber}${data}${nonce}${timestamp}`;
        blockHash.textContent = await sha256(hashInput);
        
        // Update status visual
        const status = document.getElementById("mining-status");
        if (blockHash.textContent.startsWith(difficulty)) {
            status.textContent = `Valid! Hash dimulai dengan ${difficulty}`;
            blockHash.style.color = "green";
        } else {
            status.textContent = "Tidak Valid (Hash tidak sesuai kesulitan)";
            blockHash.style.color = "red";
        }
      }

      document.getElementById("btn-mine").addEventListener("click", async () => {
        const data = blockData.value;
        const blockNumber = document.getElementById("block-number").value;
        const speedMultiplier = parseInt(speedControl.value) || 1;
        const baseBatch = 1000;
        const batchSize = baseBatch * speedMultiplier;
        const status = document.getElementById("mining-status");

        // 1. Set Timestamp saat Mining dimulai
        const timestamp = new Date().toLocaleString("en-US", {
          timeZone: "Asia/Jakarta",
        });
        blockTimestamp.value = timestamp;
        blockHash.textContent = "";
        blockNonce.value = "0";

        let nonce = 0;
        const maxNonce = 10000000; // Batasan Nonce untuk menghindari loop tak terbatas

        if (status) status.textContent = "Mining...";
        blockHash.style.color = "red";

        async function mineStep() {
          let found = false;
          const promises = [];
          for (let i = 0; i < batchSize; i++) {
            if (nonce + i > maxNonce) {
                if (status) status.textContent = "Gagal mencapai kesulitan dalam Nonce maksimal.";
                return;
            }
            // Hash input harus konsisten dengan yang diverifikasi
            const hashInput = `${blockNumber}${data}${nonce + i}${timestamp}`;
            promises.push(sha256(hashInput));
          }
          
          const results = await Promise.all(promises);

          for (let i = 0; i < results.length; i++) {
            const h = results[i];
            if (h.startsWith(difficulty)) {
              blockNonce.value = nonce + i;
              blockHash.textContent = h;
              if (status)
                status.textContent = `Mining Selesai (Nonce=${nonce + i}, Hash Valid!)`;
              blockHash.style.color = "green";
              found = true;
              return;
            }
          }
          
          if (!found) {
              nonce += batchSize;
              blockNonce.value = nonce;
              if (status) status.textContent = `Mining... Nonce=${nonce}`;
              // Lanjut mining di event loop berikutnya
              setTimeout(mineStep, 0); 
          }
        }
        mineStep();
      });

      // Panggil updateBlockHash saat load untuk inisialisasi hash awal
      updateBlockHash();
      
      // ================== APP4.JS CONTENT (TEMPORARY INLINE) ==================
      // ASUMSI: app4.js berisi logic untuk Block Chain, ECC, dan Konsensus.
      // Karena file app4.js tidak disertakan secara lengkap, saya akan mengakhiri di sini.
      // Jika Anda memberikan konten app4.js, saya dapat merapikannya lebih lanjut.
    </script>
  </body>
</html>